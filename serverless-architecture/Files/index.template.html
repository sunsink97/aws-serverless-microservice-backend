<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>AI Chat Demo</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
  :root{
    --bg:#050505;
    --panel:#0d0d0d;
    --accent:#4f46e5;
    --user:#4f46e5;
    --ai:#111827;
    --text:#e5e7eb;
    --text-soft:#9ca3af;
    --border:rgba(148,163,184,0.3);
  }
  *{margin:0;padding:0;box-sizing:border-box;font-family:system-ui}

  body{
    background:var(--bg);
    color:var(--text);
    height:100vh;
    display:flex;
    justify-content:center;
    align-items:center;
    padding:10px;
  }

  .app{
    width:100%;
    max-width:600px;
    height:80vh;
    background:var(--panel);
    border:1px solid var(--border);
    border-radius:16px;
    display:flex;
    flex-direction:column;
    overflow:hidden;
  }

  header{
    padding:14px 18px;
    font-size:16px;
    font-weight:600;
    border-bottom:1px solid var(--border);
    background:#0b0b0b;
  }

  .chat{
    flex:1;
    display:flex;
    flex-direction:column;
  }

  .chat-messages{
    flex:1;
    padding:16px;
    overflow-y:auto;
  }

  .chat-message{
    display:flex;
    gap:10px;
    margin-bottom:12px;
    max-width:75%;
  }

  .chat-message.ai{justify-content:flex-start}
  .chat-message.user{justify-content:flex-end;margin-left:auto}

  .avatar{
    width:26px;height:26px;
    border-radius:50%;
    display:flex;
    align-items:center;justify-content:center;
    font-size:13px;font-weight:600;color:white;
  }

  .avatar.ai{background:#16a34a}
  .avatar.user{background:#0ea5e9}

  .bubble{
    padding:10px 14px;
    border-radius:14px;
    white-space:pre-wrap;
    word-break:break-word;
    font-size:14px;
  }

  .ai .bubble{
    background:var(--ai);
    border:1px solid #1f2937;
  }

  .user .bubble{
    background:var(--user);
    color:white;
  }

  #typingIndicator{
    display:none;
    padding:0 16px 8px;
    font-size:12px;
    color:var(--text-soft);
  }

  .typing-dot{
    width:6px;height:6px;
    border-radius:50%;
    background:var(--text-soft);
    display:inline-block;
    animation:pulse 1s infinite ease-in-out;
    margin-right:4px;
  }
  .typing-dot:nth-child(2){animation-delay:.15s}
  .typing-dot:nth-child(3){animation-delay:.3s}

  /* input bar simplified */
  .chat-input-bar{
    padding:10px;
    border-top:1px solid var(--border);
    display:flex;
    gap:8px;
    background:#0b0b0b;
  }

  textarea{
    flex:1;background:#000;border:none;outline:none;
    color:white;font-size:14px;
    padding:8px;border-radius:10px;
    resize:none;height:38px;
  }

  button{
    background:var(--accent);
    border:none;color:white;
    padding:0 16px;font-weight:500;
    border-radius:10px;
    cursor:pointer;
    display:flex;align-items:center;
  }

  button:hover{opacity:.85}
</style>
</head>

<body>
<div class="app">
  <header>AI Chat Demo</header>

  <section class="chat">
    <div id="messages" class="chat-messages"></div>

    <div id="typingIndicator">
      <span class="typing-dot"></span>
      <span class="typing-dot"></span>
      <span class="typing-dot"></span>
      <span>AI is thinkingâ€¦</span>
    </div>

    <div class="chat-input-bar">
      <textarea id="input" placeholder="Type message..."></textarea>
      <button id="sendBtn">Send</button>
    </div>
  </section>
</div>

<script>
const API_ENDPOINT="${api_endpoint}";
const messagesEl=document.getElementById("messages");
const inputEl=document.getElementById("input");
const sendBtn=document.getElementById("sendBtn");
const typingEl=document.getElementById("typingIndicator");

append("ai","Start typing anything to initate AI.");

function append(role,text){
  const wrap=document.createElement("div");
  wrap.className="chat-message "+role;
  const avatar=document.createElement("div");
  avatar.className="avatar "+role;
  avatar.textContent=role==="user"?"U":"A";
  const bubble=document.createElement("div");
  bubble.className="bubble";
  bubble.textContent=text;
  if(role==="user"){wrap.appendChild(bubble)}
  else{wrap.appendChild(avatar);wrap.appendChild(bubble)}
  messagesEl.appendChild(wrap);
  messagesEl.scrollTop=messagesEl.scrollHeight;
}

function setLoading(v){
  typingEl.style.display=v?"block":"none";
  sendBtn.disabled=v;
  inputEl.disabled=v;
}

async function sendMessage(){
  const text=inputEl.value.trim();
  if(!text)return;
  if(text.toLowerCase()==="/clear"){messagesEl.innerHTML="";append("ai","Chat reset.");inputEl.value="";return}
  append("user",text);inputEl.value="";
  setLoading(true);
  try{
    const r=await fetch(API_ENDPOINT,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:text})});
    const d=await r.json();
    append("ai",d.reply||"[No response]");
  }catch{append("ai","Error contacting server")}
  setLoading(false);
  inputEl.focus();
}

sendBtn.onclick=sendMessage;
inputEl.onkeydown=e=>{if(e.key==="Enter"&&!e.shiftKey){e.preventDefault();sendMessage()}};
</script>
</body>
</html>
